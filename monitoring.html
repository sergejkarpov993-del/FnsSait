<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Äî ComplianceRadar</title>
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --black: #0a0a0a;
    --white: #f5f2eb;
    --cream: #ede9de;
    --accent: #c8392b;
    --accent-light: #e8503f;
    --gold: #b8972a;
    --mid: #2a2a2a;
    --gray: #6b6b6b;
    --border: rgba(200,190,170,0.2);
    --green: #4caf7d;
    --API: 'https://fnsbot-production.up.railway.app';
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--black);
    color: var(--white);
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    overflow-x: hidden;
    min-height: 100vh;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
    opacity: 0.4;
  }

  /* NAV */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 24px 48px;
    border-bottom: 1px solid var(--border);
    backdrop-filter: blur(16px);
    background: rgba(10,10,10,0.85);
  }

  .logo {
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--white);
    display: flex;
    align-items: center;
    gap: 10px;
    text-decoration: none;
  }

  .logo-dot {
    width: 8px; height: 8px;
    background: var(--accent);
    border-radius: 50%;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(0.7); }
  }

  .nav-links {
    display: flex;
    gap: 40px;
    list-style: none;
  }

  .nav-links a {
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--gray);
    text-decoration: none;
    transition: color 0.2s;
  }

  .nav-links a:hover { color: var(--white); }
  .nav-links a.active { color: var(--white); }

  .nav-cta {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--black);
    background: var(--white);
    padding: 10px 20px;
    text-decoration: none;
    transition: background 0.2s, color 0.2s;
  }

  .nav-cta:hover { background: var(--accent); color: var(--white); }

  /* BURGER */
  .burger {
    display: none;
    flex-direction: column;
    gap: 5px;
    cursor: pointer;
    padding: 4px;
    background: none;
    border: none;
    z-index: 200;
  }
  .burger span {
    display: block; width: 24px; height: 2px;
    background: var(--white); transition: all 0.3s ease; transform-origin: center;
  }
  .burger.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
  .burger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
  .burger.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

  .mobile-menu {
    display: none;
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(10,10,10,0.98);
    z-index: 150;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(20px);
  }
  .mobile-menu.open { display: flex; }
  .mobile-menu a {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(28px, 7vw, 40px);
    font-weight: 700;
    color: var(--white);
    text-decoration: none;
    padding: 20px 40px;
    width: 100%;
    text-align: center;
    border-bottom: 1px solid var(--border);
    transition: color 0.2s;
  }
  .mobile-menu a:first-child { border-top: 1px solid var(--border); }
  .mobile-menu a:hover { color: var(--gold); }

  /* PAGE HEADER */
  .page-header {
    padding: 140px 48px 60px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 24px;
    background: linear-gradient(180deg, rgba(17,17,17,0.5) 0%, transparent 100%);
  }

  .page-header-left {}

  .page-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .page-tag::before {
    content: '';
    display: inline-block;
    width: 24px; height: 1px;
    background: var(--gold);
  }

  .page-title {
    font-size: clamp(32px, 4vw, 52px);
    line-height: 1.1;
    font-weight: 700;
  }

  /* STATUS INDICATOR */
  .status-indicator {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .status-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: var(--gray);
  }

  .status-dot.online { background: var(--green); animation: pulse 2s ease-in-out infinite; }
  .status-dot.error { background: var(--accent); }

  /* MAIN CONTENT */
  .main {
    padding: 48px 48px 80px;
    display: flex;
    flex-direction: column;
    gap: 48px;
  }

  /* STATS ROW */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
  }

  .stat-card {
    background: #0f0f0f;
    padding: 32px 28px;
    position: relative;
    overflow: hidden;
  }

  .stat-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: var(--gold);
    transform: scaleX(0);
    transition: transform 0.3s ease;
    transform-origin: left;
  }

  .stat-card:hover::before { transform: scaleX(1); }

  .stat-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gray);
    margin-bottom: 12px;
  }

  .stat-value {
    font-size: 42px;
    font-weight: 700;
    line-height: 1;
    color: var(--gold);
    margin-bottom: 6px;
  }

  .stat-sub {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: rgba(107,107,107,0.6);
    letter-spacing: 0.08em;
  }

  .stat-skeleton {
    height: 42px;
    background: rgba(255,255,255,0.04);
    border-radius: 2px;
    animation: shimmer 1.5s infinite;
    margin-bottom: 6px;
  }

  @keyframes shimmer {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
  }

  /* CONTROLS */
  .controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
  }

  .filters {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .filter-btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 8px 16px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--gray);
    cursor: pointer;
    transition: all 0.2s;
  }

  .filter-btn:hover, .filter-btn.active {
    border-color: var(--white);
    color: var(--white);
    background: rgba(255,255,255,0.04);
  }

  .filter-btn.urgent.active {
    border-color: var(--accent);
    color: var(--accent);
    background: rgba(200,57,43,0.08);
  }

  .action-btns {
    display: flex;
    gap: 12px;
    align-items: center;
  }

  .btn-parse {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 10px 20px;
    background: var(--accent);
    color: var(--white);
    border: none;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .btn-parse:hover { background: var(--accent-light); transform: translateY(-1px); }
  .btn-parse:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

  .btn-refresh {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 10px 20px;
    background: transparent;
    color: var(--white);
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .btn-refresh:hover { border-color: var(--white); background: rgba(255,255,255,0.04); }

  .spin { animation: spin 1s linear infinite; }
  @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  /* DOCUMENTS TABLE */
  .docs-section {}

  .docs-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 0 20px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 0;
  }

  .docs-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gray);
  }

  .docs-count {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.08em;
    color: var(--gray);
  }

  /* DOCUMENT CARDS */
  .doc-list {
    display: flex;
    flex-direction: column;
  }

  .doc-card {
    border-bottom: 1px solid var(--border);
    padding: 28px 0;
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 24px;
    align-items: start;
    transition: background 0.2s;
    cursor: default;
  }

  .doc-card:hover { background: rgba(255,255,255,0.015); margin: 0 -48px; padding-left: 48px; padding-right: 48px; }

  .doc-index {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: rgba(107,107,107,0.4);
    letter-spacing: 0.08em;
    min-width: 28px;
    padding-top: 3px;
  }

  .doc-body {}

  .doc-meta {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
    flex-wrap: wrap;
  }

  .doc-source {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--gold);
    border: 1px solid rgba(184,151,42,0.3);
    padding: 2px 8px;
  }

  .doc-date {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: var(--gray);
    letter-spacing: 0.06em;
  }

  .doc-urgent {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--accent);
    background: rgba(200,57,43,0.1);
    border: 1px solid rgba(200,57,43,0.3);
    padding: 2px 8px;
    animation: urgentPulse 2s ease-in-out infinite;
  }

  @keyframes urgentPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
  }

  .doc-title {
    font-size: 17px;
    font-weight: 700;
    line-height: 1.3;
    margin-bottom: 8px;
    color: var(--white);
  }

  .doc-summary {
    font-size: 14px;
    line-height: 1.65;
    color: rgba(245,242,235,0.55);
    max-width: 720px;
  }

  .doc-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 12px;
  }

  .doc-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.06em;
    color: rgba(184,151,42,0.7);
    border: 1px solid rgba(184,151,42,0.2);
    padding: 2px 8px;
  }

  .doc-link {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--gray);
    text-decoration: none;
    border: 1px solid var(--border);
    padding: 8px 14px;
    transition: all 0.2s;
    white-space: nowrap;
    align-self: flex-start;
  }

  .doc-link:hover { border-color: var(--white); color: var(--white); }

  /* SKELETON CARD */
  .doc-skeleton {
    border-bottom: 1px solid var(--border);
    padding: 28px 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .sk-line {
    height: 12px;
    background: rgba(255,255,255,0.04);
    border-radius: 2px;
    animation: shimmer 1.5s infinite;
  }

  .sk-title { height: 20px; width: 70%; }
  .sk-summary { width: 90%; }
  .sk-summary2 { width: 60%; }

  /* EMPTY STATE */
  .empty-state {
    padding: 80px 0;
    text-align: center;
    border-bottom: 1px solid var(--border);
  }

  .empty-icon {
    font-size: 48px;
    margin-bottom: 20px;
    opacity: 0.3;
  }

  .empty-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 10px;
    color: rgba(245,242,235,0.4);
  }

  .empty-sub {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    color: rgba(107,107,107,0.5);
    letter-spacing: 0.08em;
  }

  /* TOAST */
  .toast {
    position: fixed;
    bottom: 32px;
    right: 32px;
    z-index: 1000;
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    letter-spacing: 0.08em;
    padding: 16px 24px;
    border: 1px solid var(--border);
    backdrop-filter: blur(16px);
    background: rgba(20,20,20,0.95);
    color: var(--white);
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.3s ease;
    max-width: 340px;
  }

  .toast.show { transform: translateY(0); opacity: 1; }
  .toast.success { border-color: rgba(76,175,125,0.5); }
  .toast.error { border-color: rgba(200,57,43,0.5); }

  /* SOURCES BREAKDOWN */
  .sources-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
  }

  .source-stat {
    background: #0a0a0a;
    padding: 24px 28px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .source-name {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    color: var(--gray);
  }

  .source-count {
    font-family: 'JetBrains Mono', monospace;
    font-size: 22px;
    font-weight: 500;
    color: var(--white);
  }

  /* ‚îÄ‚îÄ FILTER BAR (–Ω–æ–≤—ã–π) ‚îÄ‚îÄ */
  .filter-bar {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 0;
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
  }

  .filter-bar .filter-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.18em;
    color: var(--gray);
    text-transform: uppercase;
    white-space: nowrap;
    margin-right: 4px;
  }

  .filter-bar .select-wrapper {
    position: relative;
  }

  .filter-bar .select-wrapper::after {
    content: '‚ñæ';
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray);
    font-size: 10px;
    pointer-events: none;
  }

  .filter-bar select {
    appearance: none;
    background: rgba(255,255,255,0.03);
    border: 1px solid var(--border);
    color: var(--white);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 8px 32px 8px 14px;
    cursor: pointer;
    outline: none;
    transition: border-color 0.15s, color 0.15s;
    min-width: 160px;
  }

  .filter-bar select option {
    background: #1a1a1a;
    color: var(--white);
  }

  .filter-bar select:hover { border-color: rgba(200,190,170,0.4); }
  .filter-bar select:focus { border-color: var(--accent); }

  .sort-toggle {
    display: flex;
    border: 1px solid var(--border);
    overflow: hidden;
  }

  .sort-btn {
    background: rgba(255,255,255,0.02);
    border: none;
    color: var(--gray);
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 8px 16px;
    cursor: pointer;
    transition: background 0.15s, color 0.15s;
    display: flex;
    align-items: center;
    gap: 6px;
    white-space: nowrap;
  }

  .sort-btn + .sort-btn { border-left: 1px solid var(--border); }
  .sort-btn:hover { background: rgba(255,255,255,0.05); color: var(--white); }

  .sort-btn.active {
    background: rgba(200,57,43,0.08);
    color: var(--accent);
    box-shadow: inset 0 0 0 1px rgba(200,57,43,0.25);
  }

  .filter-bar .bar-divider {
    width: 1px;
    height: 24px;
    background: var(--border);
    margin: 0 4px;
  }

  .filter-bar .bar-actions {
    margin-left: auto;
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .filter-bar .filter-group {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* pills */
  .active-filters {
    display: flex;
    gap: 6px;
    margin-top: 10px;
    flex-wrap: wrap;
    min-height: 24px;
  }

  .pill {
    background: rgba(255,255,255,0.03);
    border: 1px solid var(--border);
    color: var(--gray);
    font-family: 'JetBrains Mono', monospace;
    font-size: 9px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 4px 10px;
    display: flex;
    align-items: center;
    gap: 6px;
    animation: fadeIn 0.2s ease;
  }

  @keyframes fadeIn { from { opacity: 0; transform: translateY(-4px); } to { opacity: 1; transform: none; } }

  .pill .pill-x {
    color: var(--gray);
    cursor: pointer;
    font-size: 11px;
    line-height: 1;
    transition: color 0.1s;
  }

  .pill .pill-x:hover { color: var(--accent); }

  /* LOAD MORE */
  .load-more-wrap {
    display: flex;
    justify-content: center;
    padding: 40px 0;
  }

  .btn-load-more {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 14px 32px;
    background: transparent;
    color: var(--gray);
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-load-more:hover { color: var(--white); border-color: var(--white); }
  .btn-load-more:disabled { opacity: 0.4; cursor: not-allowed; }

  /* FOOTER */
  footer {
    border-top: 1px solid var(--border);
    padding: 40px 48px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #050505;
  }

  .footer-logo {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gray);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .footer-copy {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: rgba(107,107,107,0.5);
    letter-spacing: 0.08em;
  }

  .footer-links {
    display: flex;
    gap: 32px;
  }

  .footer-links a {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--gray);
    text-decoration: none;
    letter-spacing: 0.08em;
    transition: color 0.2s;
  }

  .footer-links a:hover { color: var(--white); }

  /* RESPONSIVE */
  @media (max-width: 900px) {
    nav { padding: 20px 24px; }
    .nav-links, .nav-cta { display: none; }
    .burger { display: flex; }
    .page-header { padding: 120px 24px 48px; }
    .main { padding: 32px 24px 60px; }
    .stats-row { grid-template-columns: 1fr 1fr; }
    .sources-row { grid-template-columns: 1fr; }
    .doc-card { grid-template-columns: 1fr; gap: 12px; }
    .doc-card:hover { margin: 0; padding-left: 0; padding-right: 0; }
    .doc-index { display: none; }
    footer { flex-direction: column; gap: 20px; text-align: center; padding: 32px 24px; }
    .footer-links { flex-wrap: wrap; justify-content: center; gap: 16px; }
  }

  @media (max-width: 600px) {
    .stats-row { grid-template-columns: 1fr; }
    .controls { flex-direction: column; align-items: flex-start; }
    .action-btns { width: 100%; }
    .btn-parse, .btn-refresh { flex: 1; justify-content: center; }
  }

  
  /* ‚îÄ‚îÄ SOURCES PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
  .sources-panel {
    border: 1px solid var(--border);
    background: #080808;
    margin-bottom: 0;
  }
  .sources-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 28px;
    border-bottom: 1px solid var(--border);
  }
  .sources-panel-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--white);
  }
  .sources-panel-sub {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--gray);
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .sources-panel-sub::before {
    content: '';
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--green);
    animation: pulse 2s ease-in-out infinite;
  }
  .sources-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1px;
    background: var(--border);
  }
  .source-card {
    background: #0a0a0a;
    padding: 22px 24px;
    text-decoration: none;
    color: var(--white);
    transition: background 0.2s;
    display: flex;
    flex-direction: column;
    gap: 8px;
    cursor: pointer;
  }
  .source-card:hover { background: #0f0f0f; }
  .source-card-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }
  .source-icon { font-size: 20px; line-height: 1; }
  .source-count-badge {
    font-family: 'JetBrains Mono', monospace;
    font-size: 18px;
    font-weight: 500;
    color: var(--gold);
    line-height: 1;
  }
  .source-card-name {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.08em;
    color: var(--white);
    margin-top: 4px;
  }
  .source-card-desc {
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    line-height: 1.5;
    color: rgba(245,242,235,0.45);
  }
  .source-card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 4px;
  }
  .src-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 9px;
    letter-spacing: 0.06em;
    padding: 3px 7px;
    border: 1px solid var(--border);
    color: var(--gray);
  }
  @media (max-width: 900px) { .sources-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 500px) { .sources-grid { grid-template-columns: 1fr; } }

  /* ‚îÄ‚îÄ –ß–ò–¢–ê–ï–ú–û–°–¢–¨: –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø ‚îÄ‚îÄ */
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif !important;
      font-size: 15px;
      line-height: 1.7;
      letter-spacing: 0 !important;
    }
    h1, h2, h3, h4 {
      font-family: 'Libre Baskerville', Georgia, serif !important;
      letter-spacing: -0.01em;
    }
    /* –¢–æ–ª—å–∫–æ –º–µ—Ç–∫–∏, —Ç–µ–≥–∏, –∫–Ω–æ–ø–∫–∏ ‚Äî –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π */
    .form-tag, .step-tag, .section-num, .stat-label, .doc-source,
    .filter-btn, .tag-item, .badge, .nav-link, .logo,
    code, .code-label, .mono {
      font-family: 'JetBrains Mono', monospace !important;
    }
    /* –í–µ—Å—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç ‚Äî Inter */
    p, li, .step-desc, .stat-desc, .doc-summary, .doc-title,
    .form-sub, .left-meta, .field label, input, textarea, select,
    .notif-desc, .ind-desc, .step-text, .nav-links a {
      font-family: 'Inter', system-ui, sans-serif !important;
      letter-spacing: 0.01em;
    }
    /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
    .stat-label { font-size: 12px !important; letter-spacing: 0.08em !important; }
    .doc-source { font-size: 11px !important; }
    .filter-btn { font-size: 12px !important; }
    input, .field input { font-size: 14px !important; letter-spacing: 0 !important; }
    .nav-links a { font-size: 13px !important; letter-spacing: 0.06em !important; }
    .form-sub { font-size: 15px !important; font-family: 'Inter', sans-serif !important; letter-spacing: 0 !important; }
    /* stat value –∫—Ä—É–ø–Ω–µ–µ */
    .stat-value { font-size: clamp(36px, 5vw, 56px) !important; }
    /* doc title —á–∏—Ç–∞–µ–º–æ—Å—Ç—å */
    .doc-title { font-size: 16px !important; font-weight: 600 !important; line-height: 1.4 !important; }
    .doc-summary { font-size: 14px !important; line-height: 1.7 !important; color: rgba(245,242,235,0.65) !important; }
    /* source bar */
    .source-name { font-size: 13px !important; }
    .source-count { font-size: 22px !important; }

  
  /* ‚îÄ‚îÄ –ú–ê–°–®–¢–ê–ë 125% ‚îÄ‚îÄ */
  html {
    font-size: 125%;
  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="index.html" class="logo">
    <span class="logo-dot"></span>
    ComplianceRadar
  </a>
  <ul class="nav-links">
    <li><a href="product.html">–ü—Ä–æ–¥—É–∫—Ç</a></li>
    <li><a href="industries.html">–û—Ç—Ä–∞—Å–ª–∏</a></li>
    <li><a href="index.html#pricing">–¢–∞—Ä–∏—Ñ—ã</a></li>
    <li><a href="monitoring.html" class="active">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</a></li>
    <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
  </ul>
  <div id="userPanel" style="display:none;font-family:JetBrains Mono,monospace;font-size:11px;letter-spacing:.08em;display:flex;align-items:center;gap:16px;"><span id="userName" style="color:var(--gray)"></span><button onclick="logout()" style="background:transparent;border:1px solid var(--border);color:var(--gray);font-family:JetBrains Mono,monospace;font-size:11px;letter-spacing:.08em;padding:8px 14px;cursor:pointer;transition:all .2s" onmouseover="this.style.color='var(--white)';this.style.borderColor='var(--white)'" onmouseout="this.style.color='var(--gray)';this.style.borderColor='var(--border)'">–í—ã–π—Ç–∏</button></div>
  <button class="burger" id="burger" aria-label="–ú–µ–Ω—é">
    <span></span><span></span><span></span>
  </button>
</nav>

<!-- MOBILE MENU -->
<div class="mobile-menu" id="mobileMenu">
  <a href="product.html">–ü—Ä–æ–¥—É–∫—Ç</a>
  <a href="industries.html">–û—Ç—Ä–∞—Å–ª–∏</a>
  <a href="index.html#pricing">–¢–∞—Ä–∏—Ñ—ã</a>
  <a href="monitoring.html">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</a>
  <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
</div>

<!-- PAGE HEADER -->
<div class="page-header">
  <div class="page-header-left">
    <div class="page-tag">Live</div>
    <h1 class="page-title">–õ–µ–Ω—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h1>
  </div>
  <div class="status-indicator">
    <div class="status-dot" id="statusDot"></div>
    <span id="statusText" style="color:var(--gray);">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
  </div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- STATS -->
  <div class="stats-row" id="statsRow">
    <div class="stat-card">
      <div class="stat-label">–í—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
      <div class="stat-skeleton" id="skTotal"></div>
      <div class="stat-value" id="statTotal" style="display:none"></div>
      <div class="stat-sub">–≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ Claude</div>
      <div class="stat-skeleton" id="skProcessed"></div>
      <div class="stat-value" id="statProcessed" style="display:none"></div>
      <div class="stat-sub">–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">–°—Ä–æ—á–Ω—ã—Ö</div>
      <div class="stat-skeleton" id="skUrgent"></div>
      <div class="stat-value" id="statUrgent" style="display:none" style="color:var(--accent)"></div>
      <div class="stat-sub">–≤—Å—Ç—É–ø–∞—é—Ç –≤ —Å–∏–ª—É &lt;30 –¥–Ω–µ–π</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
      <div class="stat-skeleton" id="skSubs"></div>
      <div class="stat-value" id="statSubs" style="display:none"></div>
      <div class="stat-sub">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
    </div>
  </div>

  <!-- SOURCES PANEL -->
  <div class="sources-panel">
    <div class="sources-panel-header">
      <span class="sources-panel-title">–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>
      <span class="sources-panel-sub">–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞</span>
    </div>
    <div class="sources-grid">

      <a href="https://publication.pravo.gov.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">‚öñ</div>
          <div class="source-count-badge" id="srcPravo">‚Äî</div>
        </div>
        <div class="source-card-name">pravo.gov.ru</div>
        <div class="source-card-desc">–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –∑–∞–∫–æ–Ω—ã, —É–∫–∞–∑—ã –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞, –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞</div>
        <div class="source-card-tags">
          <span class="src-tag">–£–∫–∞–∑—ã –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞</span>
          <span class="src-tag">–ü–æ—Å—Ç. –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞</span>
          <span class="src-tag">–§–ó</span>
        </div>
      </a>

      <a href="https://www.nalog.gov.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üßæ</div>
          <div class="source-count-badge" id="srcNalog">‚Äî</div>
        </div>
        <div class="source-card-name">nalog.gov.ru</div>
        <div class="source-card-desc">–ü—Ä–∏–∫–∞–∑—ã, –ø–∏—Å—å–º–∞, —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ –§–ù–° –†–æ—Å—Å–∏–∏</div>
        <div class="source-card-tags">
          <span class="src-tag">–ü—Ä–∏–∫–∞–∑—ã –§–ù–°</span>
          <span class="src-tag">–ü–∏—Å—å–º–∞</span>
          <span class="src-tag">–û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</span>
        </div>
      </a>

      <a href="https://www.cbr.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üè¶</div>
          <div class="source-count-badge" id="srcCbr">‚Äî</div>
        </div>
        <div class="source-card-name">cbr.ru</div>
        <div class="source-card-desc">–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∞–∫—Ç—ã, –ø—Ä–µ—Å—Å-—Ä–µ–ª–∏–∑—ã –∏ —Ä–µ—à–µ–Ω–∏—è –ë–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏</div>
        <div class="source-card-tags">
          <span class="src-tag">–ù–æ—Ä–º–∞—Ç–∏–≤—ã</span>
          <span class="src-tag">–°—Ç–∞–≤–∫–∞ –¶–ë</span>
          <span class="src-tag">–ü—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è</span>
        </div>
      </a>

      <a href="https://rg.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üì∞</div>
          <div class="source-count-badge">RSS</div>
        </div>
        <div class="source-card-name">rg.ru</div>
        <div class="source-card-desc">–†–æ—Å—Å–∏–π—Å–∫–∞—è –ì–∞–∑–µ—Ç–∞ ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–æ–Ω–æ–≤ –†–§</div>
        <div class="source-card-tags">
          <span class="src-tag">–ó–∞–∫–æ–Ω—ã –†–§</span>
          <span class="src-tag">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π</span>
        </div>
      </a>

      <a href="https://www.consultant.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üìã</div>
          <div class="source-count-badge">RSS</div>
        </div>
        <div class="source-card-name">consultant.ru</div>
        <div class="source-card-desc">–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å ‚Äî –≥–æ—Ä—è—á–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞</div>
        <div class="source-card-tags">
          <span class="src-tag">–ì–æ—Ä—è—á–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</span>
          <span class="src-tag">–ù–ü–ê</span>
        </div>
      </a>

      <a href="https://minfin.gov.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üí∞</div>
          <div class="source-count-badge">RSS</div>
        </div>
        <div class="source-card-name">minfin.gov.ru</div>
        <div class="source-card-desc">–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –§–°–ë–£, –ø–∏—Å—å–º–∞ –ø–æ –±—É—Ö—É—á—ë—Ç—É, –Ω–∞–ª–æ–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞</div>
        <div class="source-card-tags">
          <span class="src-tag">–§–°–ë–£</span>
          <span class="src-tag">–ë—É—Ö—É—á—ë—Ç</span>
          <span class="src-tag">–ù–∞–ª–æ–≥–∏</span>
        </div>
      </a>

      <a href="https://mintrud.gov.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üë∑</div>
          <div class="source-count-badge">RSS</div>
        </div>
        <div class="source-card-name">mintrud.gov.ru</div>
        <div class="source-card-desc">–ú–∏–Ω—Ç—Ä—É–¥ –†–æ—Å—Å–∏–∏ ‚Äî —Ç—Ä—É–¥–æ–≤–æ–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –æ—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞</div>
        <div class="source-card-tags">
          <span class="src-tag">–¢–ö –†–§</span>
          <span class="src-tag">–û—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞</span>
        </div>
      </a>

      <a href="https://rospotrebnadzor.ru" target="_blank" class="source-card">
        <div class="source-card-top">
          <div class="source-icon">üî¨</div>
          <div class="source-count-badge">RSS</div>
        </div>
        <div class="source-card-name">rospotrebnadzor.ru</div>
        <div class="source-card-desc">–†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä ‚Äî —Å–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ –Ω–æ—Ä–º—ã, –∑–∞—â–∏—Ç–∞ –ø—Ä–∞–≤ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π</div>
        <div class="source-card-tags">
          <span class="src-tag">–°–∞–Ω–ü–∏–ù</span>
          <span class="src-tag">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</span>
        </div>
      </a>

    </div>
  </div>

  <!-- FILTER BAR -->
  <div>
    <div class="filter-bar">

      <!-- –°–∞–π—Ç -->
      <div class="filter-group">
        <span class="filter-label">–°–∞–π—Ç</span>
        <div class="select-wrapper">
          <select id="siteSelect" onchange="onSiteChange()">
            <option value="">–í—Å–µ —Å–∞–π—Ç—ã</option>
            <option value="pravo">PRAVO.GOV.RU</option>
            <option value="nalog">NALOG.GOV.RU</option>
            <option value="cbr">CBR.RU</option>
            <option value="consultant">CONSULTANT.RU</option>
            <option value="rg">RG.RU</option>
            <option value="my">–ú–æ–∏</option>
            <option value="urgent">–°—Ä–æ—á–Ω—ã–µ</option>
          </select>
        </div>
      </div>

      <div class="bar-divider"></div>

      <!-- –ü–æ—Ä—è–¥–æ–∫ -->
      <div class="filter-group">
        <span class="filter-label">–ü–æ—Ä—è–¥–æ–∫</span>
        <div class="sort-toggle">
          <button class="sort-btn active" id="btnNew" onclick="setSortOrder('new')">
            <span>‚Üë</span> –ù–æ–≤—ã–µ
          </button>
          <button class="sort-btn" id="btnOld" onclick="setSortOrder('old')">
            <span>‚Üì</span> –°—Ç–∞—Ä—ã–µ
          </button>
        </div>
      </div>

      <!-- –ü—Ä–∞–≤—ã–µ –∫–Ω–æ–ø–∫–∏ -->
      <div class="bar-actions">
        <button class="btn-refresh" onclick="loadAll()" id="refreshBtn">
          <span id="refreshIcon">‚Üª</span> –û–±–Ω–æ–≤–∏—Ç—å
        </button>
        <button class="btn-parse" onclick="triggerParse()" id="parseBtn">
          ‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
        </button>
      </div>

    </div>

    <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (pills) -->
    <div class="active-filters" id="pills"></div>
  </div>

  <!-- DOCUMENTS -->
  <div class="docs-section">
    <div class="docs-header">
      <span class="docs-title">–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</span>
      <span class="docs-count" id="docsCount">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    <div class="doc-list" id="docList">
      <!-- skeletons -->
      <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
      <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
      <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
      <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
      <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
    </div>
    <div class="load-more-wrap" id="loadMoreWrap" style="display:none">
      <button class="btn-load-more" id="loadMoreBtn" onclick="loadMore()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë</button>
    </div>
  </div>

</div>

<!-- FOOTER -->
<footer>
  <div class="footer-logo">
    <span class="logo-dot"></span>
    ComplianceRadar ¬∑ 2026
  </div>
  <div class="footer-links">
    <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
    <a href="#">–î–æ–≥–æ–≤–æ—Ä –æ—Ñ–µ—Ä—Ç—ã</a>
    <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
  </div>
  <div class="footer-copy">¬© 2026 ComplianceRadar. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</div>
</footer>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
  const API = 'https://fnsbot-production.up.railway.app';
  const CR_TOKEN = localStorage.getItem('cr_token');
  const CR_USER = JSON.parse(localStorage.getItem('cr_user') || 'null');
  let showPersonal = !!CR_TOKEN;
  let currentFilter = 'all';
  let currentOffset = 0;
  const PAGE_SIZE = 20;
  let totalDocs = 0;

  // ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  function showToast(msg, type = '') {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = 'toast show ' + type;
    setTimeout(() => { t.className = 'toast'; }, 4000);
  }

  function formatDate(iso) {
    if (!iso) return '‚Äî';
    const d = new Date(iso);
    return d.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit', year: 'numeric' });
  }

  function setStatus(online) {
    const dot = document.getElementById('statusDot');
    const txt = document.getElementById('statusText');
    if (online) {
      dot.className = 'status-dot online';
      txt.textContent = 'API –æ–Ω–ª–∞–π–Ω';
      txt.style.color = 'var(--green)';
    } else {
      dot.className = 'status-dot error';
      txt.textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
      txt.style.color = 'var(--accent)';
    }
  }

  // ‚îÄ‚îÄ STATS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  async function loadStats() {
    try {
      const res = await fetch(`${API}/stats`);
      if (!res.ok) throw new Error();
      const data = await res.json();
      setStatus(true);

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–∏—Å–ª–∞
      const fields = [
        ['skTotal', 'statTotal', data.documents.total],
        ['skProcessed', 'statProcessed', data.documents.processed],
        ['skUrgent', 'statUrgent', data.documents.urgent],
        ['skSubs', 'statSubs', data.subscribers],
      ];

      fields.forEach(([skId, valId, val]) => {
        document.getElementById(skId).style.display = 'none';
        const el = document.getElementById(valId);
        el.textContent = val ?? '0';
        el.style.display = 'block';
      });

      // –°—Ä–æ—á–Ω—ã–µ ‚Äî –∫—Ä–∞—Å–Ω—ã–º
      document.getElementById('statUrgent').style.color = 'var(--accent)';

      // –ò—Å—Ç–æ—á–Ω–∏–∫–∏
      const s = data.sources || {};
      document.getElementById('srcPravo').textContent = s['pravo.gov.ru'] ?? 0;
      document.getElementById('srcNalog').textContent = s['nalog.gov.ru'] ?? 0;
      document.getElementById('srcCbr').textContent = s['cbr.ru'] ?? 0;

    } catch (e) {
      setStatus(false);
      ['skTotal','skProcessed','skUrgent','skSubs'].forEach(id => {
        const sk = document.getElementById(id);
        sk.style.background = 'rgba(200,57,43,0.08)';
      });
    }
  }

  // ‚îÄ‚îÄ DOCUMENTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  function buildParams(offset = 0) {
    const params = new URLSearchParams({ limit: PAGE_SIZE, offset });
    if (currentFilter === 'urgent') params.set('urgency', 'true');
    if (currentFilter === 'pravo') params.set('source', 'pravo.gov.ru');
    if (currentFilter === 'nalog') params.set('source', 'nalog.gov.ru');
    if (currentFilter === 'cbr') params.set('source', 'cbr.ru');
    if (currentFilter === 'consultant') params.set('source', 'consultant.ru');
    if (currentFilter === 'rg') params.set('source', 'rg.ru');
    params.set('order', currentSortOrder === 'old' ? 'asc' : 'desc');
    return params.toString();
  }

  function getDocsUrl(offset) {
    if (showPersonal && currentFilter === 'all' && CR_TOKEN) {
      return `${API}/documents/my?limit=${PAGE_SIZE}&offset=${offset}`;
    }
    return `${API}/documents?${buildParams(offset)}`;
  }

  function renderDoc(doc, index) {
    const tags = (doc.tags || []).slice(0, 5);
    const tagsHtml = tags.length
      ? `<div class="doc-tags">${tags.map(t => `<span class="doc-tag">${t}</span>`).join('')}</div>`
      : '';

    const urgentBadge = doc.urgency
      ? `<span class="doc-urgent">‚ö† –°—Ä–æ—á–Ω–æ</span>`
      : '';

    const summary = doc.summary
      ? `<p class="doc-summary">${doc.summary}</p>`
      : `<p class="doc-summary" style="opacity:0.35;font-style:italic;">–ê–Ω–∞–ª–∏–∑ –ò–ò –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...</p>`;

    return `
      <div class="doc-card">
        <span class="doc-index">${String(index).padStart(2, '0')}</span>
        <div class="doc-body">
          <div class="doc-meta">
            <span class="doc-source">${doc.source}</span>
            <span class="doc-date">${formatDate(doc.published_at)}</span>
            ${urgentBadge}
          </div>
          <h3 class="doc-title">${doc.title}</h3>
          ${summary}
          ${tagsHtml}
        </div>
        <a class="doc-link" href="${doc.url}" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å ‚Üí</a>
      </div>
    `;
  }

  async function loadDocs(reset = true) {
    if (reset) {
      currentOffset = 0;
      document.getElementById('docList').innerHTML = `
        <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
        <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
        <div class="doc-skeleton"><div class="sk-line sk-title"></div><div class="sk-line sk-summary"></div><div class="sk-line sk-summary2"></div></div>
      `;
    }

    try {
      const headers = CR_TOKEN ? { 'Authorization': `Bearer ${CR_TOKEN}` } : {};
      const res = await fetch(getDocsUrl(currentOffset), { headers });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      totalDocs = data.total;
      const docs = data.documents || [];

      if (reset) document.getElementById('docList').innerHTML = '';

      document.getElementById('docsCount').textContent = `${totalDocs} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤`;

      if (docs.length === 0 && reset) {
        document.getElementById('docList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üì≠</div>
            <div class="empty-title">–î–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>
            <div class="empty-sub">–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
          </div>
        `;
      } else {
        const list = document.getElementById('docList');
        docs.forEach((doc, i) => {
          list.insertAdjacentHTML('beforeend', renderDoc(doc, currentOffset + i + 1));
        });
        currentOffset += docs.length;
      }

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º "–∑–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë"
      const loadMoreWrap = document.getElementById('loadMoreWrap');
      if (currentOffset < totalDocs) {
        loadMoreWrap.style.display = 'flex';
        document.getElementById('loadMoreBtn').disabled = false;
      } else {
        loadMoreWrap.style.display = 'none';
      }

    } catch (e) {
      document.getElementById('docsCount').textContent = '–æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
      if (reset) {
        document.getElementById('docList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">‚ö†</div>
            <div class="empty-title">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</div>
            <div class="empty-sub">–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –Ω–∞ Railway.</div>
          </div>
        `;
      }
    }
  }

  async function loadMore() {
    const btn = document.getElementById('loadMoreBtn');
    btn.disabled = true;
    btn.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
    await loadDocs(false);
    btn.textContent = '–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë';
  }

  async function loadAll() {
    const icon = document.getElementById('refreshIcon');
    icon.classList.add('spin');
    await Promise.all([loadStats(), loadDocs(true)]);
    icon.classList.remove('spin');
  }

  // ‚îÄ‚îÄ FILTER BAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  let currentSortOrder = 'new'; // 'new' | 'old'

  function setSortOrder(val) {
    currentSortOrder = val;
    document.getElementById('btnNew').classList.toggle('active', val === 'new');
    document.getElementById('btnOld').classList.toggle('active', val === 'old');
    updatePills();
    loadDocs(true);
  }

  function onSiteChange() {
    const val = document.getElementById('siteSelect').value;
    showPersonal = val === 'my';
    if (val === 'my') currentFilter = 'all';
    else if (val === 'urgent') currentFilter = 'urgent';
    else if (val === 'pravo') currentFilter = 'pravo';
    else if (val === 'nalog') currentFilter = 'nalog';
    else if (val === 'cbr') currentFilter = 'cbr';
    else if (val === 'consultant') currentFilter = 'consultant';
    else if (val === 'rg') currentFilter = 'rg';
    else currentFilter = 'all';
    updatePills();
    loadDocs(true);
  }

  function updatePills() {
    const site = document.getElementById('siteSelect');
    const pills = document.getElementById('pills');
    pills.innerHTML = '';

    if (site.value) {
      pills.appendChild(makePill(site.options[site.selectedIndex].text, () => {
        site.value = '';
        currentFilter = 'all';
        showPersonal = false;
        updatePills();
        loadDocs(true);
      }));
    }

    if (currentSortOrder !== 'new') {
      pills.appendChild(makePill('‚Üì –°—Ç–∞—Ä—ã–µ', () => setSortOrder('new')));
    }
  }

  function makePill(label, onRemove) {
    const d = document.createElement('div');
    d.className = 'pill';
    d.innerHTML = `${label} <span class="pill-x">‚úï</span>`;
    d.querySelector('.pill-x').onclick = onRemove;
    return d;
  }

  // ‚îÄ‚îÄ FILTER (legacy, —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ select) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  function setPersonal(btn) { /* legacy ‚Äî handled by select */ }
  function setFilter(filter, btn) { /* legacy ‚Äî handled by select */ }

  // ‚îÄ‚îÄ PARSE TRIGGER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  async function triggerParse() {
    const btn = document.getElementById('parseBtn');
    btn.disabled = true;
    btn.textContent = '‚ñ∂ –ó–∞–ø—É—Å–∫–∞–µ–º...';

    try {
      const res = await fetch(`${API}/admin/parse-now`, { method: 'POST' });
      if (!res.ok) throw new Error();
      showToast('‚úì –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–µ. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 1‚Äì2 –º–∏–Ω—É—Ç—ã.', 'success');
    } catch (e) {
      showToast('‚úó –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API.', 'error');
    } finally {
      setTimeout(() => {
        btn.disabled = false;
        btn.textContent = '‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥';
      }, 3000);
    }
  }

  // ‚îÄ‚îÄ BURGER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  const burger = document.getElementById('burger');
  const mobileMenu = document.getElementById('mobileMenu');
  burger.addEventListener('click', () => {
    burger.classList.toggle('open');
    mobileMenu.classList.toggle('open');
    document.body.style.overflow = mobileMenu.classList.contains('open') ? 'hidden' : '';
  });
  mobileMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      burger.classList.remove('open');
      mobileMenu.classList.remove('open');
      document.body.style.overflow = '';
    });
  });

  // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  if (CR_USER) {
    const panel = document.getElementById('userPanel');
    if (panel) {
      panel.style.display = 'flex';
      document.getElementById('userName').textContent = CR_USER.name || CR_USER.email;
    }
  }

  function logout() {
    fetch(`${API}/auth/logout`, { method: 'POST', headers: CR_TOKEN ? { 'Authorization': `Bearer ${CR_TOKEN}` } : {} }).catch(()=>{});
    localStorage.removeItem('cr_token');
    localStorage.removeItem('cr_user');
    window.location.href = 'login.html';
  }

  loadAll();

  // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
  setInterval(loadStats, 120000);
</script>
</body>
</html>
